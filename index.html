<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ave Mujica | 被遗弃的人偶</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --dark-purple: #1a0b2e;
            --deep-purple: #2d1b4e;
            --blood-red: #8a0303;
            --metal-silver: #c0c0c0;
            --dark-gold: #b8860b;
            --dark-gray: #1a1a1a;
        }

        body {
            font-family: 'Crimson Text', serif;
            background-color: var(--dark-gray);
            color: var(--metal-silver);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .gothic-font {
            font-family: 'Cinzel', serif;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .cursor-trail {
            position: fixed;
            top: 0;
            left: 0;
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            opacity: 0.65;
            filter: blur(0.3px);
            animation: trailFade 0.6s ease-out forwards;
            mix-blend-mode: screen;
        }

        @keyframes trailFade {
            from {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.65;
            }
            to {
                transform: translate(-50%, -50%) scale(2.1);
                opacity: 0;
            }
        }

        /* 导航栏 */
        header {
            background-color: rgba(26, 11, 46, 0.9);
            position: fixed;
            width: 100%;
            z-index: 1000;
            padding: 15px 0;
            border-bottom: 1px solid var(--blood-red);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--metal-silver);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 30px;
        }

        .nav-links a {
            color: var(--metal-silver);
            text-decoration: none;
            font-size: 1.1rem;
            transition: color 0.3s;
            position: relative;
        }

        .nav-links a:hover {
            color: var(--blood-red);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background-color: var(--blood-red);
            transition: width 0.3s;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .menu-toggle {
            display: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* 侧栏样式 */
        .sidebar {
            position: fixed;
            right: 0;
            top: 0;
            height: 100vh;
            width: 320px;
            max-width: 85vw;
            background: linear-gradient(180deg, rgba(26,11,46,0.98), rgba(26,11,46,0.95));
            color: var(--metal-silver);
            box-shadow: -12px 0 30px rgba(0,0,0,0.6);
            transform: translateX(100%);
            transition: transform 0.28s ease;
            z-index: 20050; /* 提升层级，防止被卡片或背景遮挡 */
            padding: 20px;
            overflow-y: auto;
            pointer-events: auto;
        }

        .sidebar.open {
            transform: translateX(0);
        }

        /* 覆盖模式：当侧栏需要覆盖在卡片上时生效 */
        .sidebar.overlay {
            position: fixed !important;
            transform: none !important;
            transition: none !important;
            width: 320px;
            max-width: 90vw;
            right: auto !important;
            z-index: 20100; /* 更高的备用层级（保留但通常不使用 overlay 逻辑） */
            box-shadow: 0 12px 32px rgba(0,0,0,0.6);
        }

        .sidebar.overlay.open {
            /* 确保显示时不受 slide transform 影响 */
            transform: none !important;
        }

        .sidebar .close-btn {
            display: inline-block;
            background: transparent;
            border: 1px solid rgba(192,192,192,0.08);
            color: var(--metal-silver);
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            margin-left: auto;
            float: right;
        }

        .sidebar .side-image {
            width: 100%;
            height: 220px;
            background-position: center;
            background-size: cover;
            border-radius: 8px;
            margin-bottom: 14px;
        }

        /* 新增：侧栏头部与主体布局 */
        .sidebar-header {
            background-color: #7a163a;
            color: #fff;
            padding: 12px 14px;
            border-radius: 6px 6px 0 0;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin: -20px -20px 12px -20px;
        }

        .sidebar-header h3 {
            margin: 0;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .sidebar .close-btn {
            position: absolute;
            right: 12px;
            top: 8px;
            background: transparent;
            border: 1px solid rgba(192,192,192,0.08);
            color: var(--metal-silver);
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
        }

        /* 背景音乐控制 */
        #bgMusicControl {
            position: fixed;
            left: 12px;
            bottom: 12px;
            background: rgba(26,11,46,0.9);
            color: var(--metal-silver);
            border: 1px solid rgba(192,192,192,0.08);
            padding: 8px 10px;
            border-radius: 6px;
            z-index: 12000;
            cursor: pointer;
            font-size: 0.95rem;
        }

        .side-body {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .side-image {
            flex: 0 0 140px;
            height: 260px;
            border-radius: 6px;
            background-position: center;
            background-size: cover;
            border: 2px solid rgba(255,255,255,0.04);
        }

        .side-text {
            flex: 1 1 auto;
            color: #d6d6e0;
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .side-text h4 { color: #f3f3f6; margin-top:0 }

        .side-footer {
            margin-top: 14px;
            border-top: 1px solid rgba(255,255,255,0.06);
            padding-top: 10px;
            color: #d6d6e0;
        }

        .sidebar h3 {
            margin: 8px 0 6px;
            color: var(--metal-silver);
        }

        .sidebar p { color: #d6d6e0; }

        /* 侧栏切换按钮样式已移除（按钮被删除） */

        /* 英雄区域 */
        .hero {
            height: 100vh;
            /* 使用 GitHub raw 内容链接并明确 background-size 书写（position / size） */
            background: linear-gradient(rgba(26, 11, 46, 0.8), rgba(45, 27, 78, 0.7)),
                        url("images/Ave_Mujica_MoeSR_x2_universal-fix1.jpg") no-repeat center center / cover;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
        }

        .hero-content {
            max-width: 800px;
            padding: 0 20px;
        }

        .hero h1 {
            font-size: 4rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
        }

        .hero p {
            font-size: 1.5rem;
            margin-bottom: 30px;
        }

        .cta-button {
            display: inline-block;
            padding: 12px 30px;
            background-color: var(--blood-red);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-size: 1.1rem;
            transition: all 0.3s;
            border: 2px solid var(--blood-red);
        }

        .cta-button:hover {
            background-color: transparent;
            color: var(--blood-red);
        }

        /* 关于部分 */
        .about {
            padding: 100px 0;
            background-color: var(--dark-purple);
        }

        .section-title {
            text-align: center;
            margin-bottom: 60px;
            font-size: 2.5rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            width: 100px;
            height: 3px;
            background-color: var(--blood-red);
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
        }

        .band-members {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 30px;
        }

        .member-card {
            display: block;
            width: 250px;
            text-align: center;
            background-color: rgba(45, 27, 78, 0.7);
            border-radius: 10px;
            /* 允许 tooltip 超出卡片边界显示（之前 overflow:hidden 导致被裁剪） */
            overflow: visible;
            transition: transform 0.3s ease, opacity 0.6s ease;
            position: relative; /* 使 tooltip 的绝对定位基于卡片 */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            text-decoration: none;
            color: inherit;
        }

        .member-card.card-hidden,
        .member-card.card-faded {
            opacity: 0;
            transform: translateY(18px);
        }

        .member-card.card-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .member-card:hover {
            transform: translateY(-10px);
        }

        .member-card.card-hidden:hover,
        .member-card.card-faded:hover {
            transform: translateY(18px);
        }

        .member-img {
            height: 250px;
            background-color: #333;
            background-position: center;
            background-size: cover;
            /* 保持图片顶部圆角并避免图片溢出 */
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            overflow: hidden;
        }

        .member-info {
            padding: 20px;
        }

        /* tooltip 小窗样式 */
        .member-card .tooltip {
            position: absolute;
            top: 10px;
            left: 100%;
            width: 320px;
            max-width: 80vw;
            background: #f7f7fb;
            color: #222;
            padding: 14px;
            border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.35);
            transform: translateX(12px) scale(0.98);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.18s ease, transform 0.18s ease;
            z-index: 2000;
            border: 1px solid rgba(0,0,0,0.08);
        }

        /* 当空间不足时将 tooltip 翻向左侧显示 */
        .member-card .tooltip.left {
            left: auto;
            right: 100%;
            transform: translateX(-12px) scale(0.98);
        }

        /* 左侧箭头 */
        .member-card .tooltip.left::before {
            left: auto;
            right: -8px;
            border-right: none;
            border-left: 8px solid #f7f7fb;
        }

        /* 提高悬停或激活状态下卡片的堆叠顺序，避免 tooltip 被相邻元素遮挡 */
        .member-card:hover,
        .member-card.tooltip-visible {
            z-index: 4000;
        }

        .member-card .tooltip h4 {
            margin-bottom: 8px;
            font-size: 1.05rem;
            color: #3a2a4a;
        }

        .member-card .tooltip p {
            font-size: 0.95rem;
            line-height: 1.4;
            color: #333;
            margin-bottom: 6px;
        }

        /* 鼠标悬停或带类时显示 */
        .member-card:hover .tooltip,
        .member-card.tooltip-visible .tooltip {
            opacity: 1;
            pointer-events: auto;
            transform: translateX(0) scale(1);
        }

        /* 小箭头 */
        .member-card .tooltip::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 18px;
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid #f7f7fb;
        }

        .member-name {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--metal-silver);
        }

        .member-role {
            color: var(--blood-red);
            font-style: italic;
        }

        /* 音乐部分 */
        .music {
            padding: 100px 0;
            background-color: var(--deep-purple);
        }

        .albums {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
        }

        .album-card {
            width: 300px;
            background-color: rgba(26, 11, 46, 0.8);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        .album-cover {
            height: 300px;
            background-color: #444;
            background-position: center;
            background-size: cover;
        }

        .album-info {
            padding: 20px;
        }

        .album-title {
            font-size: 1.4rem;
            margin-bottom: 10px;
        }

        .album-year {
            color: var(--blood-red);
            margin-bottom: 15px;
        }

        .play-button {
            display: inline-block;
            padding: 8px 20px;
            background-color: var(--blood-red);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .play-button:hover {
            background-color: #6a0202;
        }

        /* 巡演部分 */
        .tour {
            padding: 100px 0;
            background-color: var(--dark-purple);
        }

        .tour-dates {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 40px;
        }

        .tour .member-card {
            width: 300px;
        }

        .tour .member-img {
            height: 200px;
        }

        .tour-cta {
            margin-top: 40px;
            text-align: center;
        }

        .buy-ticket {
            display: inline-block;
            padding: 8px 20px;
            background-color: transparent;
            color: var(--blood-red);
            border: 2px solid var(--blood-red);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }

        .buy-ticket:hover {
            background-color: var(--blood-red);
            color: white;
        }

        /* 页脚 */
        footer {
            background-color: var(--dark-gray);
            padding: 50px 0 20px;
            text-align: center;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .social-links a {
            color: var(--metal-silver);
            font-size: 1.5rem;
            transition: color 0.3s;
        }

        .social-links a:hover {
            color: var(--blood-red);
        }

        .copyright {
            color: #666;
            font-size: 0.9rem;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 70px;
                left: 0;
                width: 100%;
                background-color: var(--dark-purple);
                padding: 20px;
                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
            }

            .nav-links.active {
                display: flex;
            }

            .nav-links li {
                margin: 10px 0;
            }

            .menu-toggle {
                display: block;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.2rem;
            }

            .member-card {
                width: 100%;
                max-width: 300px;
            }

            .tour-date {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <header>
        <div class="container">
            <nav>
                <a href="#" class="logo gothic-font">AVE MUJICA</a>
                <ul class="nav-links">
                    <li><a href="#home">首页</a></li>
                    <li><a href="#about">关于</a></li>
                    <li><a href="#music">音乐</a></li>
                    <li><a href="#tour">巡演</a></li>
                    <li><a href="#contact">联系</a></li>
                </ul>
                <div class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                
            </nav>
        </div>
    </header>

    <!-- 英雄区域 -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h1 class="gothic-font">AVE MUJICA</h1>
            <p>「ようこそ、ave mujicaの世界へ」</p>
            <a href="#music" class="cta-button">沉入梦境</a>
        </div>
    </section>

    <!-- 侧栏（用于显示成员详细信息） -->
    <aside class="sidebar" id="memberSidebar" aria-hidden="true">
        <div class="sidebar-header">
            <h3 id="sideName">oblivionis</h3>
            <button class="close-btn" id="closeSidebar" aria-label="关闭侧栏">关闭</button>
        </div>
        <div class="side-body">
            <div class="side-image" id="sideImage" style="background-image: url('images/180px-Ave_mujica_member_5.jpg')"></div>
            <div class="side-text" id="sideContent">
                <p>在这里显示成员的详细介绍。你可以点击任意成员卡把信息加载到侧栏。</p>
            </div>
        </div>
        <div class="side-footer">
            <p id="sideRole">键盘、队长</p>
        </div>
    </aside>

    <!-- 关于部分 -->
    <section class="about" id="about">
        <div class="container">
            <h2 class="section-title gothic-font">关于乐队</h2>
            <div class="band-members">
                <!-- 1) 保留 Oblivionis（含 tooltip） -->
                <a class="member-card" href="members/oblivionis.html">
                    <div class="member-img" style="background-image: url('images/180px-Ave_mujica_member_5.jpg')"></div>
                    <div class="member-info">
                        <h3 class="member-name">oblivionis</h3>
                        <p class="member-role">键盘、队长</p>
                    </div>
                    <div class="tooltip" role="dialog" aria-hidden="true">
                        <h4>丰川祥子 / Oblivionis（オブリビオニス）</h4>
                        <p>Oblivionis 取自 Lacus Oblivionis（忘湖），意指忘却。</p>
                        <p><strong>担当：</strong>键盘手</p>
                        <p><strong>生日：</strong>2月14日　<strong>星座：</strong>水瓶座</p>
                        <p>羽丘女子学园高中1年级，丰川集团的大小姐，言谈举止十分优雅。曾是 CRYCHIC 的键盘手。</p>
                        <p>怀着守护所有成员人生的觉悟组建了 Ave Mujica，为守护 Ave Mujica 的世界观倾注心血。</p>
                        <p><strong>代表色：</strong> <span style="color:#7799CC">#7799CC</span></p>
                        <p><strong>CV：</strong> 高尾奏音</p>
                    </div>
                </a>

                <!-- 2) 二号人物（使用 workspace 中的素材文件） -->
                <a class="member-card" href="members/doloris.html">
                    <!-- 请将你提供的 Doloris 图片保存为 images/Doloris.jpg（或 .webp/.png），下面引用将使用该路径 -->
                    <div class="member-img" style="background-image: url('images/Doloris.jpg')"></div>
                    <div class="member-info">
                        <h3 class="member-name">Doloris</h3>
                        <p class="member-role">主唱、主音吉他</p>
                    </div>
                    <!-- Doloris 的详情（作为 tooltip 内容被侧栏引用） -->
                    <div class="tooltip" role="dialog" aria-hidden="true">
                        <h4>三角初华 / Doloris（ドロリス）</h4>
                        <p>Doloris 取自 Lacus Doloris（悲湖），意指悲伤。</p>
                        <p><strong>担当：</strong>主唱 / 主音吉他手</p>
                        <p><strong>生日：</strong>6月26日</p>
                        <p><strong>星座：</strong>巨蟹座</p>
                        <p>花咲川女子学园高中1年级，和椎名立希、八幡海玲是同一个班级，因工作关系经常缺席。</p>
                        <p>偶像团体「sumimi」的吉他手，此时艺名为初华，负责作词作曲。</p>
                        <p>因其酷炫的外观而受欢迎，喜爱观星。受幼时相识的祥子邀请，加入了 Ave Mujica，担当作词。</p>
                        <p>代表色： <span style="color:#BB9955">#BB9955</span></p>
                        <p><strong>CV：</strong> 佐佐木李子</p>
                    </div>
                </a>

                <!-- 3-5) 占位成员（为将来填充预留） -->
                <a class="member-card" href="members/mortis.html">
                    <div class="member-img" style="background-image: url('images/Mortis.jpg')"></div>
                    <div class="member-info">
                        <h3 class="member-name">Mortis</h3>
                        <p class="member-role">吉他</p>
                    </div>
                    <div class="tooltip" role="dialog" aria-hidden="true">
                        <h4>若叶瞳 / Mortis（モーティス）</h4>
                        <p>Mortis 取自 Lacus Mortis（死湖），意指死亡。</p>
                        <p><strong>担当：</strong>吉他手</p>
                        <p><strong>生日：</strong>1月14日</p>
                        <p><strong>星座：</strong>摩羯座</p>
                        <p>月之森女子学园高中1年级。曾是 CRYCHIC 的吉他手。</p>
                        <p>情感表达不多，基本上是一个沉默寡言的人。父亲是知名喜剧艺人若叶，母亲是女演员森美奈美。</p>
                        <p>与祥子互为青梅竹马，自幼学习吉他，技艺精湛。</p>
                        <p>代表色： <span style="color:#779977">#779977</span></p>
                        <p><strong>CV：</strong> 渡瀬结月</p>
                    </div>
                </a>

                <a class="member-card" href="members/timoris.html">
                    <div class="member-img" style="background-image: url('images/Timoris.jpg')"></div>
                    <div class="member-info">
                        <h3 class="member-name">Timoris</h3>
                        <p class="member-role">贝斯</p>
                    </div>
                    <div class="tooltip" role="dialog" aria-hidden="true">
                        <h4>八幡海玲 / Timoris（ティモリス）</h4>
                        <p>Timoris 取自 Lacus Timoris（恐湖），意指恐怖。</p>
                        <p><strong>担当：</strong>贝斯手</p>
                        <p><strong>生日：</strong>4月7日　<strong>星座：</strong>白羊座</p>
                        <p>花咲川女子学园高中1年级。</p>
                        <p>贝斯技巧达到了职业水准，同时担任多支乐团的支援乐手，负责安排成员日务，工作认真细致。</p>
                        <p>代表色： <span style="color:#335566">#335566</span></p>
                        <p><strong>CV：</strong> 冈田梦以</p>
                    </div>
                </a>

                <a class="member-card" href="members/amoris.html">
                    <div class="member-img" style="background-image: url('images/Amoris.jpg')"></div>
                    <div class="member-info">
                        <h3 class="member-name">Amoris</h3>
                        <p class="member-role">鼓手</p>
                    </div>
                    <div class="tooltip" role="dialog" aria-hidden="true">
                        <h4>祐天寺若麦 / Amoris（アモリス）</h4>
                        <p>Amoris 名取自 Lacus Amoris（爱湖），意指爱与热情。</p>
                        <p><strong>担当：</strong>鼓手</p>
                        <p><strong>生日：</strong>9月2日　<strong>星座：</strong>处女座</p>
                        <p>擅长多种打击乐器，节奏感极强，舞台上能量十足，是乐队的节奏中坚。</p>
                        <p>为人开朗，常负责排练节奏与现场节拍控制。</p>
                        <p>代表色： <span style="color:#AA4455">#AA4455</span></p>
                        <p><strong>CV：</strong>米泽茜</p>
                    </div>
                </a>
            </div>
        </div>
    </section>

    <!-- 音乐部分 -->
    <section class="music" id="music">
        <div class="container">
            <h2 class="section-title gothic-font">音乐作品</h2>
            <div class="albums">
                <!-- 占位：为未来六首歌保留位置 -->
                <div class="album-card">
                    <div class="album-cover" style="background-image: url('images/Ave Mujica.jpg')"></div>
                    <div class="album-info">
                        <h3 class="album-title">Ave Mujica</h3>
                        <p class="album-year">2023-9-13(MyGO ep.13)</p>
                        <p>亲亲们别再问了，我们这边没有键盘版的春日影哦。</p>
                        <button class="play-button" data-music="Ave Mujica - Ave Mujica.mp3">播放</button>
                    </div>
                </div>
                <div class="album-card">
                    <div class="album-cover" style="background-image: url('images/KiLLKiSS.jpg')"></div>
                    <div class="album-info">
                        <h3 class="album-title">KiLLKiSS</h3>
                        <p class="album-year">2025-1-8(Mujica OP)</p>
                        <p>这是一架冲向云霄的银河战舰！</p>
                        <button class="play-button" data-music="Ave Mujica - KiLLKiSS.mp3">播放</button>
                    </div>
                </div>
                <div class="album-card">
                    <div class="album-cover" style="background-image: url('images/Crucifix X.jpg')"></div>
                    <div class="album-info">
                        <h3 class="album-title">Crucifix X</h3>
                        <p class="album-year">2025-3-6(Mujica ep.10)</p>
                        <p>still alive=steal a life</p>
                        
                        <button class="play-button" data-music="Ave Mujica - Crucifix X.mp3">播放</button>
                    </div>
                </div>
                <div class="album-card">
                    <div class="album-cover" style="background-image: url('images/天球(そら)のMúsica.jpg')"></div>
                    <div class="album-info">
                        <h3 class="album-title">天球(そら)のMúsica</h3>
                        <p class="album-year">2025-4-3(Mujica ep.13)</p>
                        <p>那满天的星光,一定是神明大人送给爱看星星的小女孩的礼物吧。</p>
                        <button class="play-button" data-music="Ave Mujica - 天球(そら)のMúsica.mp3">播放</button>
                    </div>
                </div>
                <div class="album-card">
                    <div class="album-cover" style="background-image: url('images/Symbol III  ▽.jpg')"></div>
                    <div class="album-info">
                        <h3 class="album-title">Symbol III  ▽</h3>
                        <p class="album-year">2024-6-15(ELEMENTS)</p>
                        <p>听一千遍Symbol III : ▽就能回到一月二日的那个晚上吗。</p>
                        <button class="play-button" data-music="Ave Mujica - Symbol III _ ▽.mp3">播放</button>
                    </div>
                </div>
                <div class="album-card">
                    <div class="album-cover" style="background-image: url('images/in your blue eyes.jpg')"></div>
                    <div class="album-info">
                        <h3 class="album-title">in your blue eyes</h3>
                        <p class="album-year">2025-9-4(Collaboration with Arknights)</p>
                        <p>这就是领养手续吗？我同意了。</p>
                        <button class="play-button" data-music="Ave Mujica & 塞壬唱片-MSR - in your blue eyes.mp3">播放</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 巡演部分 -->
    <section class="tour" id="tour">
        <div class="container">
            <h2 class="section-title gothic-font">巡演日期</h2>
            <div class="tour-dates">
                <div class="member-card">
                    <div class="member-img" data-bg="live1_Ulterius Procedere.jpg" style="background-color:#2b1638;"></div>
                    <div class="member-info">
                        <h3 class="member-name">Ave Mujica 6th LIVE「Ulterius Procedere」</h3>
                        <p class="member-role">2025年12月14日(日) 开场16:30／开演17:30</p>
                        <p class="member-role">東京国際フォーラム ホールA</p>
                        <p class="member-role">2026年1月15日(木) 开场17:30／开演18:30</p>
                        <p class="member-role">グランキューブ大阪 メインホール</p>
                    </div>
                </div>

                <div class="member-card">
                    <div class="member-img" data-bg="live2_ave-mujica-live-tour.jpg" style="background-color:#2b1638;"></div>
                    <div class="member-info">
                        <h3 class="member-name">Ave Mujica LIVE TOUR</h3>
                        <p class="member-role">2026年4月17日(金)  Zepp Fukuoka</p>
                        <p class="member-role">2026年4月26日(日)  Zepp Namba</p>
                        <p class="member-role">2026年5月1日(金)  Zepp Nagoya</p>
                        <p class="member-role">2026年5月4日(月)  Zepp Haneda (TOKYO)</p>
                    </div>
                </div>

                <div class="member-card">
                    <div class="member-img" data-bg="live3_moment memory.jpg" style="background-color:#2b1638;"></div>
                    <div class="member-info">
                        <h3 class="member-name">MyGO!!!!!×Ave Mujica TWO-MAN LIVE「"moment / memory"」</h3>
                        <p class="member-role">2026年3月1日(日) 开场15:30／开演17:00</p>
                        <p class="member-role">Kアリーナ横浜</p>
                    </div>
                </div>
            </div>
            <div class="tour-cta">
                <a href="https://bang-dream.com/events" class="buy-ticket" target="_blank" rel="noopener">购票</a>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer id="contact">
        <div class="container">
            <div class="social-links">
                <a href="https://space.bilibili.com/1459104794"><i class="fab fa-bilibili"></i></a>
                <a href="https://www.youtube.com/@bang_dream_AveMujica"><i class="fab fa-youtube"></i></a>
                <a href="https://www.instagram.com/bang_dream_official_"><i class="fab fa-instagram"></i></a>
                
                <a href="https://x.com/BDP_AveMujica"><i class="fab fa-x"></i></a>
            </div>
            <p class="copyright">© 2025 Anon HUST. 保留所有权利。</p>
        </div>
    </footer>

    <button id="bgMusicControl" aria-label="背景音乐">背景音乐：播放中</button>

    <script src="background-music.js"></script>
    <script>
        // 移动端菜单切换
        document.querySelector('.menu-toggle').addEventListener('click', function() {
            document.querySelector('.nav-links').classList.toggle('active');
        });

        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                if(targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if(targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                    
                    // 移动端点击后关闭菜单
                    if(window.innerWidth <= 768) {
                        document.querySelector('.nav-links').classList.remove('active');
                    }
                }
            });
        });

        // 播放按钮交互
        document.querySelectorAll('.play-button').forEach(button => {
            button.addEventListener('click', function() {
                const albumTitle = this.parentElement.querySelector('.album-title').textContent;
                alert(`正在播放 ${albumTitle} 专辑中的歌曲`);
            });
        });

        // 仅在触摸设备上保留点击切换 tooltip（因为 hover 在触摸屏上无效）
        if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
            document.querySelectorAll('.member-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // 如果点击的是卡片内部的链接或按钮，不拦截
                    if (e.target.closest('a') || e.target.closest('button')) return;
                    // 切换类并更新 aria
                    const isVisible = this.classList.toggle('tooltip-visible');
                    const tooltip = this.querySelector('.tooltip');
                    if (tooltip) {
                        // 在显示前检测是否需要翻转方向
                        updateTooltipDirection(this, tooltip);
                        tooltip.setAttribute('aria-hidden', (!isVisible).toString());
                    }
                });
            });
        }

        // 鼠标移入时也检查方向以避免遮挡（桌面）
        document.querySelectorAll('.member-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                const tooltip = this.querySelector('.tooltip');
                if (tooltip) updateTooltipDirection(this, tooltip);
            });
        });

        // 当窗口大小变化时，重新计算当前可见 tooltip 的方向
        window.addEventListener('resize', function() {
            document.querySelectorAll('.member-card').forEach(card => {
                const tooltip = card.querySelector('.tooltip');
                if (!tooltip) return;
                // 只为可见或悬停的卡片更新方向
                if (card.classList.contains('tooltip-visible') || card.matches(':hover')) {
                    updateTooltipDirection(card, tooltip);
                }
            });
        });

        // helper: 根据卡片与视口位置判断是否把 tooltip 翻向左侧
        function updateTooltipDirection(card, tooltip) {
            // 计算卡片距离视口右边的空间
            const rect = card.getBoundingClientRect();
            // 尝试读取 tooltip 的宽度（回退到 CSS 320）
            let tipWidth = 320;
            try {
                const cs = window.getComputedStyle(tooltip);
                const w = parseFloat(cs.width);
                if (!isNaN(w) && w > 0) tipWidth = w;
            } catch (e) {}
            const padding = 16; // 额外留白
            if (rect.right + tipWidth + padding > window.innerWidth) {
                tooltip.classList.add('left');
            } else {
                tooltip.classList.remove('left');
            }
        }

        // 卡片浮现与淡出效果
        (function initMemberCardReveal(){
            var cards = Array.prototype.slice.call(document.querySelectorAll('.member-card'));
            if(!cards.length){return;}
            cards.forEach(function(card){
                card.classList.add('card-hidden');
            });
            var observer = new IntersectionObserver(function(entries){
                entries.forEach(function(entry){
                    var el = entry.target;
                    if(entry.intersectionRatio >= 0.3){
                        el.dataset.revealed = 'true';
                        el.classList.add('card-visible');
                        el.classList.remove('card-hidden');
                        el.classList.remove('card-faded');
                    } else if(el.dataset.revealed === 'true'){
                        el.classList.remove('card-visible');
                        el.classList.add('card-faded');
                    }
                });
            }, {threshold:[0,0.3,0.31]});
            cards.forEach(function(card){observer.observe(card);});
        })();

        // 侧栏：打开/关闭与填充内容
        const sidebar = document.getElementById('memberSidebar');
        const sideImage = document.getElementById('sideImage');
        const sideName = document.getElementById('sideName');
        const sideRole = document.getElementById('sideRole');
        const sideContent = document.getElementById('sideContent');
        const sidebarToggle = document.querySelector('.sidebar-toggle-btn');
        const sidebarClose = document.getElementById('closeSidebar');

        function openSidebar() {
            // 如果不是 overlay 模式，确保使用默认的抽屉定位（清理上次可能残留的内联样式）
            if (!sidebar.classList.contains('overlay')) {
                sidebar.style.position = '';
                sidebar.style.left = '';
                sidebar.style.top = '';
                sidebar.style.right = '';
                sidebar.style.transform = '';
            }
            sidebar.classList.add('open');
            sidebar.setAttribute('aria-hidden', 'false');
        }
        function closeSidebar() {
            // 关闭时总是清理 overlay 状态与内联定位，恢复为抽屉样式的干净状态
            sidebar.classList.remove('open');
            sidebar.setAttribute('aria-hidden', 'true');
            sidebar.classList.remove('overlay');
            sidebar.style.position = '';
            sidebar.style.left = '';
            sidebar.style.top = '';
            sidebar.style.right = '';
            sidebar.style.transform = '';
        }

        if (sidebarToggle) sidebarToggle.addEventListener('click', () => {
            // 如果已经打开则关闭
            if (sidebar.classList.contains('open')) closeSidebar(); else openSidebar();
        });
        if (sidebarClose) sidebarClose.addEventListener('click', () => {
            // 关闭时清理任何覆盖定位样式
            sidebar.style.left = '';
            sidebar.style.top = '';
            sidebar.style.transform = '';
            sidebar.classList.remove('overlay');
            closeSidebar();
        });

        // 点击成员卡时填充并打开侧栏（恢复：始终以右侧抽屉显示，移除 overlay 行为）
        document.querySelectorAll('.member-card').forEach(card => {
            card.addEventListener('click', function(e) {
                // 如果点击的是卡片内部的链接或按钮，不拦截
                if (e.target.closest('a') || e.target.closest('button')) return;

                const nameEl = this.querySelector('.member-name');
                const roleEl = this.querySelector('.member-role');
                const imgEl = this.querySelector('.member-img');
                const tooltipEl = this.querySelector('.tooltip');

                if (nameEl) sideName.textContent = nameEl.textContent;
                if (roleEl) sideRole.textContent = roleEl.textContent;
                if (imgEl) {
                    const bg = window.getComputedStyle(imgEl).backgroundImage;
                    if (bg && bg !== 'none') {
                        const url = bg.replace(/^url\(["']?/, '').replace(/["']?\)$/, '');
                        sideImage.style.backgroundImage = `url('${url}')`;
                    }
                }
                if (tooltipEl) {
                    sideContent.innerHTML = tooltipEl.innerHTML;
                    // 隐藏该卡片上的白底 tooltip，避免覆盖侧栏
                    this.classList.remove('tooltip-visible');
                    tooltipEl.setAttribute('aria-hidden', 'true');
                } else {
                    sideContent.innerHTML = '<p>暂无详细信息。</p>';
                }

                // 强制使用右侧抽屉样式：清理任何 overlay 相关内联样式与类
                sidebar.classList.remove('overlay');
                sidebar.style.position = '';
                sidebar.style.left = '';
                sidebar.style.top = '';
                sidebar.style.right = '';
                sidebar.style.transform = '';
                sidebar.style.width = '';
                sidebar.style.zIndex = '';

                openSidebar();
            });
        });

        // 自动将 images/ 目录中的文件作为 member-img 背景（基于 data-bg 属性）
        (function applyLocalBackgrounds() {
            document.querySelectorAll('.member-img').forEach(el => {
                const file = el.getAttribute('data-bg');
                if (!file) return; // 没有指定 data-bg
                // 先检测是否已有内联 background-image
                if (el.style.backgroundImage && el.style.backgroundImage !== 'none') return;
                const url = `images/${file}`;
                const img = new Image();
                img.onload = function() {
                    el.style.backgroundImage = `url('${url}')`;
                    el.style.backgroundSize = 'cover';
                    el.style.backgroundPosition = 'center';
                };
                img.onerror = function() {
                    // 文件不存在或加载失败，保持原 background-color
                    // 你可以在控制台看到提示
                    console.warn(`背景图片未找到: ${url}`);
                };
                img.src = url;
            });
        })();

        const trailColors = [
            '#7799cc', // Oblivionis
            '#bb9955', // Doloris
            '#779977', // Mortis
            '#335566', // Timoris
            '#aa4455'  // Amoris
        ];
        let lastTrailTime = 0;
        const trailMinInterval = 16; // ms, 约等于 60fps

        window.addEventListener('pointermove', function(e) {
            const now = Date.now();
            if (now - lastTrailTime < trailMinInterval) return;
            lastTrailTime = now;

            const dot = document.createElement('span');
            dot.className = 'cursor-trail';
            dot.style.width = '14px';
            dot.style.height = '14px';
            dot.style.left = e.clientX + 'px';
            dot.style.top = e.clientY + 'px';
            dot.style.background = trailColors[Math.floor(Math.random() * trailColors.length)];
            document.body.appendChild(dot);

            // 在动画结束后清理节点
            setTimeout(() => {
                dot.remove();
            }, 600);
        }, { passive: true });

        // 背景音乐：跨页面保留播放状态
        initBackgroundMusic({
            buttonSelector: '#bgMusicControl',
            playlist: [
                'Ave Mujica - Ave Mujica.mp3',
                'Ave Mujica - KiLLKiSS.mp3',
                'Ave Mujica - Crucifix X.mp3',
                'Ave Mujica - 天球(そら)のMúsica.mp3',
                'Ave Mujica - Symbol III _ ▽.mp3',
                'Ave Mujica & 塞壬唱片-MSR - in your blue eyes.mp3'
            ],
            basePath: 'musics/',
            storageKey: 'aveMujicaBgMusicState'
        });

        // 音乐播放控制：把每个 .play-button 绑定到 musics/ 目录中的文件
        (function bindPlayButtons() {
            const audio = new Audio();
            audio.preload = 'none';
            let currentButton = null;

            function setButtonPlaying(btn, playing) {
                if (!btn) return;
                btn.textContent = playing ? '暂停' : '播放';
                btn.classList.toggle('playing', playing);
            }

            document.querySelectorAll('.play-button').forEach(btn => {
                const fname = btn.getAttribute('data-music');
                if (!fname) return;
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    // 如果当前按钮是同一首歌：切换播放/暂停
                    if (currentButton === btn) {
                        if (audio.paused) {
                            audio.play();
                            setButtonPlaying(btn, true);
                        } else {
                            audio.pause();
                            setButtonPlaying(btn, false);
                        }
                        return;
                    }

                    // 切换到新曲目：停止旧的，设置新 src 并播放
                    if (currentButton) setButtonPlaying(currentButton, false);
                    currentButton = btn;
                    const src = 'musics/' + encodeURIComponent(fname).replace(/%20/g, ' ');
                    // 为兼容含中文/特殊字符的文件名，使用 encodeURIcomponent but keep spaces as spaces
                    // 暂停背景音乐（若存在）
                    if (window.__bgMusicControl && window.__bgMusicControl.pause) try { window.__bgMusicControl.pause(); } catch (e) {}
                    audio.src = src;
                    audio.currentTime = 0;
                    audio.play().then(() => setButtonPlaying(btn, true)).catch(err => {
                        console.error('播放失败', err);
                        // 若播放被阻止，允许背景恢复
                        if (window.__bgMusicControl && window.__bgMusicControl.resume) try { window.__bgMusicControl.resume(); } catch(e){}
                    });
                });
            });

            // 当音频结束时，重置按钮状态
            audio.addEventListener('ended', () => {
                setButtonPlaying(currentButton, false);
                currentButton = null;
                if (window.__bgMusicControl && window.__bgMusicControl.resume) try { window.__bgMusicControl.resume(); } catch(e){}
            });

            audio.addEventListener('pause', () => {
                // 当手动暂停时，更新按钮文本
                setButtonPlaying(currentButton, false);
                // 暂停时让背景音乐恢复（如果存在）
                if (window.__bgMusicControl && window.__bgMusicControl.resume) try { window.__bgMusicControl.resume(); } catch(e){}
            });
        })();
    </script>
</body>

</html>
